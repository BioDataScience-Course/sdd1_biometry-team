---
title: "Etude de la biométrie humaine"
author: "Laura Braeckevelt, Laura Toubeau, Margaux Renier, Lisa Mussoi"
date: "14/11/2018"
output: 
  html_notebook:
    html_notebook:
    Fig_caption: yes
    number_section: yes
    toc: yes
---

# Introduction
  Nous avons interrogé une série de personnes, selon des critères bien définis, sur leurs caractéristiques physiques (taille, masse, mensurations), leurs habitudes alimentaires ainsi que sur leur activité physique aussi bien de nature sportive que dans la cadre professionnel. Ces données une fois répertoriées, nous nous sommes lancés dans une analyse de la biométrie humaine.

![*L'homme de Vitruve*](pictures/homme_vitruve.jpg)

# But
  Récolte de données autour de la biométrie humaine afin de tirer des conclusions, suite à une analyse statistique appronfondie, quant au taux de cas d'obésité dans le hainaut particulièrement.

# Matériels et méthodes

  Nous avons interrogé plusieurs personnes dans une tranche d'âge de 15 à 70 ans. Ensuite, nous les avons pesé en considérant une seule et unique balance afin de conserver la même erreur pour toutes les valeurs. C'est d'ailleurs pour cette raison qu'une conversion en fonction de l'erreur calculée pour la balance de laboratoire fût nécessaire. Un mètre ruban nous a également servi à mesurer leur tour de poignet, leur tour de taille, leur tour de hanche et leur hauteur. 
De plus, plusieurs questions leur ont été posées concernant : leur âge, leur genre, leur activité physique, leur profession (sédentaire, intermédiaire, active), leur consommation d'alcool(nombre de verre par semaine), le nombre de fast-food par mois, de repas et de grignotage(s) par jour, la comsommation de viande hebdomadaire (quantitative) et leur lieu de résidence (dans le Hainaut ou non).

Dans un premier temps, ces diverses données ont été collectées et retranscrites dans une google sheet, cette googlesheet doit ensuite être importée. Pour ce faire, on utilise la fonction "read" et on colle le lien de la google sheet en le mettant en format "csv". Ile est nécessaire que ces ces données soient filtrées pour supprimer les "NA" c'est-à-dire les données non encodées pour avoir des résulats plus clairs. Ils sont clairs certes mais doivent être également exploitables sous forme de graphiques, voilà pourquoi, pour bien commencer à travailler, on définit les variables numériques et les variables facteurs. En dernier lieu, on effectue quelques tests et graphiques afin de pouvoir analyser et représenter les résultats de cette expérience. 

```{r setup, include=FALSE}
#packages
SciViews::R
library(skimr)
library(visdat)
library(viridis)
```


```{r importation data}
#import data

#biometry_2018 <- read$csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQoVtSWbENWzxbALxD0qyNDqxV4uSYqzLCtJgcNGE7ciT6nkWOjA9b6dMBHaSUY8Nw5f-mSpUEeN-3S/pub?output=csv ")

biometry_2018 <- readr::read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vQoVtSWbENWzxbALxD0qyNDqxV4uSYqzLCtJgcNGE7ciT6nkWOjA9b6dMBHaSUY8Nw5f-mSpUEeN-3S/pub?output=csv", locale = locale(decimal_mark = ","))
write(biometry_2018, file = "../biometry_2018.rds", type = "rds")
```

```{r}
summary(biometry_2018)
```

```{r}
filter(biometry_2018,genre != "NA", hainaut!= "n") -> biometry
```

```{r}
biometry$acti_physique <- as.numeric(biometry$acti_physique)
```


```{r}
biometry$acti_physique <- as.numeric(biometry$acti_physique)
```

```{r}
biometry$alcool <- as.numeric(biometry$alcool)
```

```{r}
biometry$fastfood <- as.numeric(biometry$fastfood)
```

```{r}
visdat::vis_dat(biometry)
```


# Résultats

##Test

###Test de Student

```{r Test de Student}
skim(biometry_2018)
```

####Distribution du poids par genre pour la biométrie humaine

```{r graphique masse et genre}
chart(biometry_2018, masse_corr ~ genre %fill=% genre) + geom_boxplot(na.rm = TRUE)+
  scale_fill_viridis_d()+
  ylab("Masse (kg)")+ 
  xlab("Genre")+
  stat_summary(geom = "point", fun.y="mean", col="red")
```
 
  On observe que les hommes tendent à avoir une masse plus importante que celle des femmes mais cette différence est-elle significative ou peut-elle être juste liée au hasard de l’échantillonnage ?
 Pour y répondre, nous devons élaborer un test d’hypothèse qui va confronter les hypothèses suivantes (en se basant sur les moyennes) :  

H0 : les moyennes du poids des hommes et des femmes ne sont pas significatvements différents  
H1 : les moyennes du poids des hommes et des femmes sont différentes  
 
```{r test de student}
t.test(data = biometry_2018, masse_corr ~ genre,
  alternative = "two.sided", conf.level = 0.95, var.equal = TRUE)
```

Prenons une valeur de α de 5% (α = 0,05). On compare cette valeur de α avec notre valeur de p qui est de : p-value = 1.095e-08.  

On doit rejeter H0 car p<<<<α, il se situe donc dans la zone de rejet.  

###Test de l'Anova à un facteur

Les tests t de Student est limité à la comparaison de deux populations. Aussi, poursuivons notre analyse de la biométrie humaine en comparant simultanément les hommes et les femmes des différents types d'activités professionnelles, ce qui nous donne au totale six sous-populations à comparer.  

```{r}
biometry %>.%
  mutate(., group  = labelise(
    factor(paste(acti_profession, genre, sep = "-")),
    "Groupe activité professionnelle - genre", units = NA)) ->
  biometry_anova
```

```{r}
biometry_anova %>.%
  mutate(., masse_corr2 = labelise(
    as.numeric(masse_corr / 176,6),
    "Ratio masse / masse totale max", units = NA)) %>.%
  select(., genre, acti_profession, group, masse_corr2) ->
  biometry_anova
skimr::skim(biometry_anova)
```

####Masse en fonction des groupes d'hommes et de femmes
```{r}
chart(data = biometry_anova, masse_corr2 ~ group) +
  geom_violin() +
  geom_jitter(width = 0.05, alpha = 0.5) +
  geom_point(data = group_by(biometry_anova, group) %>.%
    summarise(., means = mean(masse_corr2, na.rm = TRUE)),
    f_aes(means ~ group), size = 3, col = "red")+
  ylab("Ratio masse / masse totale max ")+
  coord_flip()
```


On distingue en rouge la moyenne et les observations individuelles en noir semi-transparent superposées à des graphiques en violon.  


Pour que l'ANOVA puisse être appliquée deux conditions sont absolument nécessaires :  
1) Distribution normale des résidus  
2) Il doit y avoir homoscédaticité  

La condition d'homoscédaticité peut être vérifiée à l'aide d'un test de Bartlett. Ses hypothèses sont :  
H0:Il y a homoscédaticité   
H1:Il y n'y a pas d'homoscédaticité, on parle alors d'hétéroscédaticité  



Considérons un seuil α de 5% pour nos tests. 

```{r bartlett test pour biometry_2018}
bartlett.test(data = biometry_anova, masse_corr2 ~ group)

```

Nous rejettons H0 car il n'y a pas d'homoscédasticité.  

Essayons de stabiliser la variance avce le logarithme népérien de masse_corr.  
```{r}
biometry_anova %>.%
  mutate(., log_masse_corr2 = ln(masse_corr2)) ->
  biometry_anova
bartlett.test(data = biometry_anova, log_masse_corr2 ~ group)
```
La variance n'est pas stabilisée.  

Une transformation à l'aide de puissance peut être réalisée:  
```{r}
biometry_anova %>.%
  mutate(., masse5 = masse_corr2^6) ->
  biometry_anova

bartlett.test(data = biometry_anova, masse5 ~ group)
```
Cette transformation ne stabilise pas la variance. Peu importe les modifications apportées à notres jeu de données, nous restons en-dessous du seuil α de 5%.  

Sans cette condition d'homoscédaticité, le test de l'ANOVA n'est pas applicable et non adéquat. Il faut donc réaliser un test de Kruskal-Wallis.  

###Test de Kruskal-Wallis

Le test de Kuskal-Wallis utilise les hypothèses suivantes :  
H0 : Les rangs moyens sont significativement les mêmes.  
H1 : Il existe au moins deux rangs moyens différents.  

```{r}
kruskal.test(data = biometry_anova, masse_corr2 ~ group)
```
Nous rejettons ici H0 au seuil α de 5% ce qui signifie qu'il y a au minimum une différence entre les ratios au seuil α de 5%.  

Notre analyse n’est pas terminée. Nous devons maintenant réaliser un test post-hoc non paramétrique.  

```{r}
summary(kw_comp. <- nparcomp::nparcomp(data = biometry_anova, masse_corr2 ~ group))
```

```{r}
plot(kw_comp.)
```
>Conclusion? (je ne sais pas quoi mettre laura t.)



##Graphiques

```{r}
Genre <- as.table(c(
  "Homme"   = 103,
  "Femme"    = 109))
```


###Répartition des individus suivant le genre
```{r}
chart(data = as_dataframe(Genre), n ~ 1 %fill=% factor(Var1, levels = Var1)) +
  geom_bar(width = 1, stat = "identity") +
  geom_text(f_aes(cumsum(rev(n)) - rev(n)/2  ~ 1.2, label = rev(n))) +
  labs(fill = "Genre") +
  coord_polar(theta = "y") +
  theme_void()+ 
  scale_fill_manual(values = c("darkmagenta", "pink"))

```

  Il y a une répartition égale des hommes et des femmes, le nombre de femmes étant supérieur.

###Histogramme montrant la distribution de la masse des hommes et des femmes suivant leur activité professionnelle
```{r}
chart(data = biometry, ~ masse_corr %col=% genre %fill=% genre | acti_profession) + 
  geom_histogram(binwidth = 5)+
   ylab("Dénombrement")+ 
  xlab("Masse (kg)")
```
  
  
  Ce graphique permet une vue d'ensemble des données. On consate que la majorité des personnes interrogées sont sédentaires avec une majeure tendance pour les femmes. Qui plus est, il est clairement remarquable que les masses les plus élevées ont été enregistrées chez ces mêmes personnes sédentaires ce qui nous conforte dans l'idée que la sédentarité peut être l'une des causes de surpoids.
  
###Masse des hommes et des femmes en fonction de leur âge avec observation de l'activité professionnelle 
```{r} 
chart(data = biometry, masse_corr ~ age %col=% acti_profession | genre) +
  geom_point(alpha = 0.5) +
  labs(x = "Age [a]", y = "Masse [kg]")
```
 
 
 Nous observons que les hommes ont tendance de manière générale à avoir une masse plus élevée que celle des femmes à partir de la vingtaine. De plus, cette masse a tendance à s'accroître avec l'âge davantage chez les hommes que chez les femmes. Avec ce graphique on remarque que l'activité professionelle n'influence pas beaucoup la masse ce qui est étonnnant. En effet chez les femmes, on remarque que certes la sédentarité est en corrélation avec une masse plus lourde mais on remarque également des femmes actives avec une masse supérieure à celle de ces mêmes personnes sédentaires. Chez les hommes, on voit que beaucoup d'actifs sont plus lourds que la majorité des sédentaires
 
 
###Masse des hommes et des femmes en fonctions de leurs avec avec une jauge du nombre de fastfood par semaine. 
```{r}
chart(data = biometry, masse_corr ~ age %col=% fastfood) +
  geom_point(na.rm = TRUE) +
  labs(x = "Age [a]", y = "Masse [kg]")
```
 
 Ce graphique nous permet de voir l'influence des fatsfood sur le poids. Dans un premier temps on remarque que chez les jeunes (jusque 20-25 ans) le nombre de fastfood par semaine n'influence pas beaucoup leurs poids, on peut voir que entre 40 et 80kg chez les jeunes les fatsfood vont de 0 à 3 par semaine sans différence marquante dans leurs poids sauf une ou 2 exeptions. Chez les personnes plus agées (40 à 60ans et plus) même conclusion on ne voit pas différence significative au niveau des fastfood entre les différents poids, on voit que les personnes plus lourdes ne mange pas spécialement plus de fastfood et que les personnes plus mince n'en mange pas spécialement moins. 
 
###Graphique de la masse en focntion de l'activité physique  
```{r}
chart(data = biometry, masse ~ acti_physique) +
  geom_violin() 
```

 L'activité influence le poids, jusqu'a 70kg on voit que le nombre d'heure de sport par semaine est très grand et qu'il diminue lorsque que l'on augmente dans la masse. 
 
 
```{r}
chart(data = biometry, ~ factor(0) %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() 
```
  
  Ce graphique permet de voir la répartition des activités physiques, car cela peut influencer l'obésité et l'on observe plus de sédentaire que d'actif ou d'intermédiare on peut donc penser que l'échantillon tend plus vers l'obésité. (cela n'est qu'une hypohèse )
>Je ne prends pas la décision de le supprimer moi mais je trouverais plus judicieux d'utiliser un graphique en camembert pour mettre en avant la répartition de l'obésité (laura t.)
  
```{r}
chart(data = biometry, ~ acti_physique %col=% genre %fill=% genre) + 
  geom_histogram(binwidth = 2)
```
 
  On remarque une decroissance lorsqu'on avance dans les heures de sport par semaine, la plus grande partie fait 0h de sport mais on remarque qu'un partie est comprise entre 1 et 10h de sport ceci  infleunce donc aussi le poid chez une personne. 
  
```{r}
chart(biometry,taille~masse %col=% genre) +
  geom_point() + labs(x = "masse", y  = "taille") 
```

On remarque que c'est plus au moins proprotionnel (sauf quelques exeptions) la grande majorité à un poids qui est proportionnel à leurs taille ce qui montre que le hainaut n'est pas en obésité. De plus on observe que la plus part des femmes sont plus légère et plus petite que les hommes. 


##IMC 
```{r}
biometry <- mutate(biometry, imc= masse_corr / taille^2)
biometry
```

```{r}
biometry <- mutate(biometry,
  imc_schedule = case_when(
    imc < 18.5 ~ "sous_poids",
    imc >= 18.5 & imc < 25 ~ "poids_normal",
    imc >= 25 & imc < 30 ~ "surpoids",
    imc >= 30 ~ "obésité"
))

biometry
```

```{r}
biometry$imc_schedule <- as.factor(biometry$imc_schedule)
```

```{r}

```

 
###Répartition des individus suivant leur position sur l'échetlle d'IMC

```{r}
chart(data = biometry, ~ imc_schedule %fill=% imc_schedule) +
  geom_bar(position = "dodge") +
  ylab("Effectifs") +
  scale_fill_viridis_d()+
  xlab("IMC schedule")
```


  Nous pouvons remarquer que sur 212 individus plus de la moitié (118) possèdent un poids pouvant être qualifié de normal selon l'échelle d'IMC (soit imc >= 18.5 & imc < 25). Néanmoins environ 35% des individus de cet échantillon sont également caractérisés par un imc supérieur à la moyenne avec 47 individus en surpoids et 33 qui souffrent d'obésité. La tendance pour un poids inférieur à la moyenne étant moindre avec 14 individus soit environ 7%. Nous pouvons donc retenir que même si plus de la moitié des personnes de cet échantillon ont un poids considéré comme "normal", une autre partie non négligeable possède un poids pouvant être qualifié de nocif pour un état de santé favorable.
 


###Répartition des différents stades sur l'échelle d'IMC suivant le tour de hanche, le tour de taille et le tour de poignet
```{r}
a <- chart(data = biometry, tour_hanche ~ imc_schedule %fill=% imc_schedule) +
  geom_violin() +
  coord_flip()+
  xlab("IMC schedule")+
  ylab("Tour de hanche (cm)")

b <- chart(data = biometry, tour_taille ~ imc_schedule %fill=% imc_schedule) +
  geom_violin() +
  coord_flip()+
  xlab("IMC schedule")+
  ylab("Tour de taille (cm)")

c <- chart(data = biometry, tour_poignet ~ imc_schedule %fill=% imc_schedule) +
  geom_violin() +
  coord_flip()+
  xlab("IMC schedule")+
  ylab("Tour de poignet (cm)")

combine_charts(list(a, b, c ), common.legend = TRUE)
```

Sur base de ce graphique, nous pouvons relever que les valeurs pour les deux variables "tour de hanche"" et "tour de taille" se répartissent de manière plus ou moins semblables ce qui peut nous indiquer d'une part une certaine corrélation entre la répartiton générale de ces valeurs et la corpulence de l'individu ainsi qu'une certaine proportionalité dans les mensurations de la personne.
Aussi, les individus considérés comme souffrants d'obésité sont ceux qui présentent les valeurs les plus élevées de tour de hanche et de taille (allant de +/- 100 à 170cm), suivis des cas de surpoids, de poids normal et enfin de sous-poids, ce qui n'est pas surprenant.
La mesure de ces parties du corps est donc un méthode assez représentative de la corpulence générale de la personne, pouvant laisse apparaître un certain surpoids ou au contraire une maigreur significative.
En ce qui concerne la mesure du tour de poignet, elle permet d'appuyer les résultats précédents en terme de surpoids et d'obésité. Néanmoins en ce qui concerne la maigreur il ne s'agit pas d'un bon indicateur étant donné que certaines personnes ayant un poids normal ont un tour de poignet encore inférieur aux personnes en situation de sous-poids même si une légère tendance peut être remarquée avec une tendance globale accrûe chez ces personnes entre 13 et 18 cm. 

###Illustration de la consommation d'alcool des différents individus suivant leur activité professionnelle
```{r}
chart(data = biometry, ~ alcool %fill=% acti_profession | acti_profession) +
  geom_histogram(bins = 25) +
  ylab("Effectifs") +
  scale_fill_viridis_d()
```

Nous constatons qu'il n'y a pas une différence drastique dans la consommation d'alcool des personnes actives, intermédiaires et sédentaires. Sur base de ce graphique nous pouvons uniquement remarquer que les personnes actives et sédentaires ont tendance à consommer davantage d'alcool que les personnes intermédiaires. Cependant, les personnes sédentaires une tendance à la consommation d'alcool un peu plus élevées avec des consommations pour une petite minorité pouvant aller jusqu'à 42 verres par semaine.

```{r}
 c <- filter (biometry, imc_schedule == "sous_poids")%>.%
  chart(., ~ imc_schedule %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()  

 d <- filter (biometry, imc_schedule == "poids_normal")%>.%
  chart(., ~ imc_schedule %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()  
 
 e <- filter (biometry, imc_schedule == "surpoids")%>.%
  chart(., ~ imc_schedule %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()  
 
 f <- filter (biometry, imc_schedule == "obésité")%>.%
  chart(., ~ imc_schedule %fill=% acti_profession) +
  geom_bar(width = 1) + 
  coord_polar("y", start = 0) +
  theme_void() +
  scale_fill_viridis_d()  
 
 combine_charts(list(c, d, e, f), common.legend = TRUE)
 
```
> Mettre un titre A = Sous-poids, B= Poids normal, C= Surpoids, D= Obésité

```{r}
chart(data = biometry, ~ fastfood | imc_schedule ) +
  stat_density() +
  ylab("Densité")
```

#Discussion

Le test de student effectué nous montre que le poids des femmes et des hommes sont différents et il n’est pas dû au hasard de l’échantillonage. 
Les personnes ayant participé au sondage sont essentiellement des femmes (109 femmes pour 103 hommes).
Les femmes ont tendance à avoir un travail sédentaire serait-il une raison au surpoids ? Cependant elles ont tout de même un poids moins élevée en moyenne que les hommes.
Le poids fluctuent de manière étrange et nous obtenons des résultats inattendus comme des femmes actives qui ont un poids plus élevé que celles qui sont sédentaires. On observe ce même phénomène chez les hommes.  Est-ce que l’activité professionnelle n’aurait pas d’influence sur le poids ?
Les fastfood n’influent par sur le poids des jeunes car ceux-ci sont en pleine croissance et un métabolisme plus performant. Et il n’y a pas de lien entre les personnes ayant un poids plus élevé et le nombre de fastfood par semaine donc le sfastfoods n’auraient pas d’influence réelle
Par contre le sport a une influence sur le poids, en effet les personnes pratiquant du sport ont un poids moins élevé que celle qui ne le pratique pas ou peu. Le poid est généralement proportionnele a la taille ce qui montrerait que le hainaut n’est pas en surpoids en moyenne.
On constate aussi avec le graphique représentant l’imc que ceux-ci sont généralement en poids normal et très peu sont en en obésité 
Les personnes souffrant d’obésité ont un tour de taille et un tour de hanche plus élevé que la moyenne ce qui  est logique considérant leur poids élevé
Les personnes ayant une activité professionnelle sédentaire ont une consommation plus grande en alcool que les autres.

#Conclusion 

On constate en général que les hommes ont un poids plus élevé que celui des femmes cela peut s'expliquer par le fait que leur masse musculaire est plus grande à cause la testostérone et ils sont généralement plus grand et nous avons vu que le poids était proportionnel à la taille.
Les jeunes ont tendance à avoir un poids plus équilibrer qu'il fasse du sport, qu'ils boivent de l'alcool ou non. Ils ont une meilleure conditions physique et récupère plus vite que les adultes car ils sont encore en pleine croissance. Donc même s'ils mangent gras ou consomment beaucoup de viandes, cela n'a pas un réel effet sur leur imc.
Les personnesâgées mangent moins bien et n'ont pplus d'activité physique fréquente ni d'activité professionnelle nonplus donc ils ont tendance à prende du poids.
Nous constatons aussi que l'activité professionnelle n'est pas un bon indicateur pour savoir si les personnes qui sont moins actives au travail sont plus lourds car il y a d'autres facteurs à prendre en compte comme les repas oou encore le sport et la quantité de verre d'alcool par semaine. 
Sur nos graphique on s'aperçoit également que le hainaut n'est pas en obésité. Nous avons une grande majorité des personnes en poids normal. 
